---
layout: default
title: ä¸»é¡µ
---

<style>
  /* === â€œå…¨éƒ¨å±•å¼€/æ”¶èµ·â€æµ®åŠ¨æŒ‰é’®æ ·å¼ (å·²æ¢å¤) === */
  .floating-toggle-wrapper {
    position: fixed;
    bottom: 30px;
    right: 30px;
    z-index: 1000;
    display: none; /* é»˜è®¤éšè—ï¼Œåªåœ¨â€œåˆ†ç±»è§†å›¾â€ä¸‹æ˜¾ç¤º */
  }
  .floating-toggle-btn {
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #ccc;
    color: #333;
    padding: 8px 15px;
    cursor: pointer;
    font-size: 14px;
    border-radius: 20px;
    outline: none;
    box-shadow: 0 2px 10px rgba(0,0,0,0.15);
    transition: all 0.2s ease-in-out;
  }
  .floating-toggle-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  }

/* === â€œçŸ¥è¯†æŒ‘æˆ˜â€æµ®åŠ¨æŒ‰é’®æ ·å¼ (Resized to match) === */
  .floating-quiz-wrapper {
    position: fixed;
    bottom: 75px; /* Adjusted from 85px so the gap between buttons looks natural */
    right: 30px;
    z-index: 1000;
  }
  .floating-quiz-btn {
    /* Modern Gradient Background */
    background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
    color: white;
    
    /* --- Size Adjustments Start --- */
    padding: 8px 15px;       /* Changed from 12px 24px to match Toggle button */
    font-size: 14px;         /* Changed from 16px to match Toggle button */
    border-radius: 20px;     /* Changed from 50px to match Toggle button */
    /* --- Size Adjustments End --- */

    border: none;
    font-weight: 600; 
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(37, 117, 252, 0.3);
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    display: flex;
    align-items: center;
    gap: 6px; 
  }
  .floating-quiz-btn:hover {
    background: linear-gradient(135deg, #5b0eb0 0%, #1a60d6 100%);
    transform: translateY(-2px); /* Slight reduction in hover movement to match smaller size */
    box-shadow: 0 6px 20px rgba(37, 117, 252, 0.5);
  }
  .floating-quiz-btn:active {
    transform: translateY(-1px);
  }

  /* === é¡µè„šçš„è§†å›¾åˆ‡æ¢æŒ‰é’®æ ·å¼ (ä½è°ƒ) === */
  .footer-view-switcher {
    text-align: center;
    margin-top: 40px;
    padding-top: 20px;
    border-top: 1px solid #eee;
  }
  .footer-view-switcher .switch-btn {
    background: none;
    border: none;
    color: #888;
    cursor: pointer;
    font-size: 0.9rem;
    text-decoration: underline;
    padding: 5px;
    margin: 0 10px;
  }
  .footer-view-switcher .switch-btn:hover {
    color: #007bff;
  }
  .footer-view-switcher .switch-btn.active {
    color: #333;
    font-weight: bold;
    text-decoration: none;
    cursor: default;
  }

  /* === æ›´æ–°æ—¥å¿—é¢æ¿æ ·å¼ === */
  .changelog-container {
    margin-bottom: 25px;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    background-color: #f9f9f9;
    box-shadow: 0 1px 4px rgba(0,0,0,0.05);
  }
  .changelog-summary {
    font-size: 1rem;
    font-weight: 600;
    padding: 5px 20px;
    cursor: pointer;
    outline: none;
  }
  .changelog-summary::-webkit-details-marker { display: none; }
  .changelog-summary::before { content: '+'; font-family: monospace; font-weight: bold; font-size: 1rem; margin-right: 12px; color: #888; display: inline-block; width: 20px; text-align: center; }
  details[open] > .changelog-summary::before { content: 'âˆ’'; }

  .changelog-panel {
    padding: 0 20px 15px 20px;
    border-top: 1px solid #e0e0e0;
    max-height: 30vh;
    overflow-y: auto;
  }
  .changelog-panel ul {
    list-style-type: none;
    padding-left: 0;
    margin: 10px 0 0 0;
  }
  .changelog-panel li {
    padding: 4px 0;
    font-size: 0.9rem;
  }
  .changelog-panel .commit-date {
    font-weight: bold;
    color: #555;
  }
  .changelog-panel .commit-message {
    font-style: italic;
    color: #777;
    margin-left: 10px;
  }
  .changelog-panel .change-list {
    padding-left: 20px;
    list-style-type: disc;
    margin-top: 5px;
  }

  /* --- åˆ†ç±»è§†å›¾å†…éƒ¨çš„æ ·å¼ --- */
  /* Tab æ ·å¼ */
  .tab { overflow: hidden; border-bottom: 1px solid #ddd; }
  .tab button { background-color: transparent; float: left; border: none; outline: none; cursor: pointer; padding: 0.7rem 1rem; transition: background-color 0.3s; font-size: 1rem; color: #555; border-radius: 6px 6px 0 0; }
  .tab button:hover:not(.active) { background-color: #f1f1f1; }
  .tab button.active { background-color: #e9e9e9; font-weight: bold; color: #333; }
  .tabcontent { display: none; padding: 0px 0; animation: fadeEffect 0.5s; }
  @keyframes fadeEffect { from {opacity: 0;} to {opacity: 1;} }

  /* å¯æŠ˜å åˆ—è¡¨æ ·å¼ */
  .collapsible-book { border-bottom: 1px solid #e0e0e0; }
  .collapsible-book:first-of-type { border-top: 1px solid #e0e0e0; }
  summary { font-size: 1rem; font-weight: 600; padding: 0.5rem 0px; cursor: pointer; list-style: none; outline: none; margin-bottom:0!important; transition: background-color 0.2s; color: #504949ff; }
  summary:hover { background-color: #f7f7f7; }
  summary::-webkit-details-marker { display: none; }
  summary::before { content: 'âˆ’'; font-family: monospace; font-weight: bold; font-size: 1rem; margin-right: 12px; color: #888; display: inline-block; width: 20px; text-align: center; }
  details:not([open]) > summary::before { content: '+'; }
  .collapsible-book ul { list-style-type: none; padding: 10px 0 15px 42px; margin: 0; }
  .collapsible-book li { padding: 0.1rem 0; border: none; }

  /* æ—¶é—´çº¿è§†å›¾çš„æ ·å¼ */
  .timeline-list { list-style-type: none; padding-left: 0; }
  .timeline-list li, .timeline-list-no-date li { display: flex; align-items: baseline; padding: 0.2rem 0; }
  /* .timeline-list li { border-bottom: 1px solid #eee; } ç”µæŠ¥Tabå¸¦ä¸‹åˆ’çº¿ */
  /* .timeline-list-no-date li { border-bottom: none; } æ—¶é—´çº¿Tabä¸å¸¦ä¸‹åˆ’çº¿ */
  .timeline-date { margin: 0 1rem; flex-shrink: 0; font-size: 0.8rem; }
  .unknown-date-header { margin-top: 40px; padding-top: 20px; border-top: 2px solid #ccc; font-size: 1rem; font-weight: bold; color: #555; }
</style>

<div class="floating-toggle-wrapper">
  <button class="floating-toggle-btn" onclick="toggleAllMaster('#new-view .collapsible-book')">å…¨éƒ¨å±•å¼€/æ”¶èµ·</button>
</div>

<div class="floating-quiz-wrapper">
  <button class="floating-quiz-btn" onclick="window.location.href='{{ '/quiz/index.html' | relative_url }}'">ğŸ’¡ çŸ¥è¯†æŒ‘æˆ˜</button>
</div>

<div id="new-view" class="view-panel">
  {%- assign memorial_posts_raw = "" | split: "" -%}
  {%- assign telegrams_raw = "" | split: "" -%}
  {%- assign magazines_raw = "" | split: "" -%}
  {%- assign collections_to_search = "liaos_writings,ten_year_memorial,n6a_memorial,n22d_memorial,battles_history,liaos_tele,newspapers" | split: "," -%}
  {%- for collection_name in collections_to_search -%}
    {%- for post in site[collection_name] -%}
      {%- if post.category == "Liao's Tele" -%}{%- assign telegrams_raw = telegrams_raw | push: post -%}{%- elsif post.category == "æŠ¥åˆŠæ‚å¿—" -%}{%- assign magazines_raw = magazines_raw | push: post -%}{%- else -%}{%- assign memorial_posts_raw = memorial_posts_raw | push: post -%}{%- endif -%}
    {%- endfor -%}
  {%- endfor -%}

  <details class="changelog-container">
    <summary class="changelog-summary">æ›´æ–°æ—¥å¿—</summary>
    <div class="changelog-panel">
      <ul>
        {%- for item in site.data.changelog -%}
          <li>
            <span class="commit-date">{{ item.date }}</span> - <span class="commit-message">"{{ item.commit_message }}"</span>
            <ul class="change-list">
              {%- for change in item.changes -%}
                <li><a href="{{ change.url | relative_url }}">{{ change.title }}</a></li>
              {%- endfor -%}
            </ul>
          </li>
        {%- endfor -%}
      </ul>
    </div>
  </details>

  <div class="tab">
    <button class="tablinks" onclick="openTab(event, 'byBook')" id="byBook-tab">æŒ‰ä¹¦ç±</button>
    <button class="tablinks" onclick="openTab(event, 'byTime')" id="byTime-tab">æŒ‰æ—¶é—´</button>
    <button class="tablinks" onclick="openTab(event, 'telegrams')" id="telegrams-tab">ç”µæŠ¥</button>
    <button class="tablinks" onclick="openTab(event, 'magazines')" id="magazines-tab">æŠ¥åˆŠæ‚å¿—</button>
  </div>
  
  <div id="byBook" class="tabcontent">
    {%- if memorial_posts_raw and memorial_posts_raw.size > 0 -%}
      {%- assign posts_by_book = memorial_posts_raw | group_by: "category" -%}
      {%- for book in posts_by_book -%}
        <details class="collapsible-book" open>
          <summary>ã€Š{{ book.name }}ã€‹</summary>
          <ul>
            {%- assign items_sorted_by_title = book.items | sort: 'title' -%}
            {%- for post in items_sorted_by_title -%}<li><a href="{{ post.url | relative_url }}">{{ post.title }}</a>{%- if post.author -%}ï¼ˆ{{ post.author }}ï¼‰{%- endif -%}</li>{%- endfor -%}
          </ul>
        </details>
      {%- endfor -%}
    {%- else -%}<p>æœªèƒ½ç”Ÿæˆåˆ—è¡¨ã€‚</p>{%- endif -%}
  </div>

  <div id="byTime" class="tabcontent">
    {%- assign timeline_posts = memorial_posts_raw | concat: magazines_raw -%}
    {%- if timeline_posts and timeline_posts.size > 0 -%}
      {%- assign dated_posts = "" | split: "" -%}{%- assign undated_posts = "" | split: "" -%}
      {%- for post in timeline_posts -%}{%- assign formatted_date = post.date | date: "%Y-%m-%d" -%}{%- if formatted_date == "1900-01-01" or post.date == nil -%}{%- assign undated_posts = undated_posts | push: post -%}{%- else -%}{%- assign dated_posts = dated_posts | push: post -%}{%- endif -%}{%- endfor -%}
      {%- if dated_posts.size > 0 -%}
        {%- assign posts_by_year = dated_posts | group_by_exp: "post", "post.date | date: '%Y'" | sort: "name" | reverse -%}
        {%- for year_group in posts_by_year -%}
          <details class="collapsible-book" open>
            <summary>{{ year_group.name }} å¹´</summary>
            <ul class="timeline-list-no-date">
              {%- assign posts_in_year = year_group.items | sort: 'date' | reverse -%}
              {%- for post in posts_in_year -%}<li><a href="{{ post.url | relative_url }}">{{ post.title }}</a>{%- if post.author -%}ï¼ˆ{{ post.author }}ï¼‰{%- endif -%}</li>{%- endfor -%}
            </ul>
          </details>
        {%- endfor -%}
      {%- endif -%}
      {%- if undated_posts.size > 0 -%}<h3 class="unknown-date-header">æš‚æ— æ—¶é—´</h3><ul>{%- assign undated_posts_sorted = undated_posts | sort: 'title' -%}{%- for post in undated_posts_sorted -%}<li><a href="{{ post.url | relative_url }}">{{ post.title }}</a>{%- if post.author -%}ï¼ˆ{{ post.author }}ï¼‰{%- endif -%}</li>{%- endfor -%}</ul>{%- endif -%}
    {%- else -%}<p>æœªèƒ½ç”Ÿæˆåˆ—è¡¨ã€‚</p>{%- endif -%}
  </div>
  
  <div id="telegrams" class="tabcontent">
    {%- assign telegrams = telegrams_raw | sort: 'date' -%}
    {%- if telegrams.size > 0 -%}
      {%- assign periods = "" | split: "," -%}
      {%- assign p1 = "end_date:1938-02-26|title:ã€æ•™å¯¼æ€»é˜Ÿä¸­æ ¡å‚è°‹ä¸»ä»»ã€‘å—äº¬ä¿å«æˆ˜" | split: "|" -%}
      {%- assign p2 = "start_date:1938-02-26|end_date:1942-01-01|title:ã€æ–°äºŒäºŒå¸ˆå‰¯å¸ˆé•¿ã€‘æ¡‚å—ä¼šæˆ˜" | split: "|" -%}
      {%- assign p3 = "start_date:1942-01-01|end_date:1942-05-16|title:ã€æ–°äºŒäºŒå¸ˆå¸ˆé•¿ã€‘ç¬¬ä¸€æ¬¡å…¥ç¼…ä½œæˆ˜" | split: "|" -%}
      {%- assign p4 = "start_date:1942-05-16|end_date:1942-10-01|title:ã€æ–°äºŒäºŒå¸ˆå¸ˆé•¿ã€‘å¾’æ­¥é‡äººå±±" | split: "|" -%}
      {%- assign p5 = "start_date:1942-10-01|end_date:1943-11-01|title:ã€æ–°äºŒäºŒå¸ˆå¸ˆé•¿ã€‘é©»å°å†›æ•´è®­" | split: "|" -%}
      {%- assign p6 = "start_date:1943-11-01|end_date:1944-09-01|title:ã€æ–°äºŒäºŒå¸ˆå¸ˆé•¿ã€‘ç¼…åŒ—èƒœåˆ©åæ”»ï¼ˆèƒ¡åº·æ²³è°·ï¼‰" | split: "|" -%}
      {%- assign p7 = "start_date:1944-09-01|end_date:1945-01-01|title:ã€æ–°å…­å†›å†›é•¿ã€‘ç¼…åŒ—èƒœåˆ©åæ”»ï¼ˆå…«è«ã€è…ŠæˆŒï¼‰" | split: "|" -%}
      {%- assign p8 = "start_date:1945-01-01|end_date:1945-05-01|title:ã€æ–°å…­å†›å†›é•¿ã€‘äº‘å—æ›²é–æ•´è®­å¾…å‘½" | split: "|" -%}
      {%- assign p9 = "start_date:1945-05-01|end_date:1945-08-15|title:ã€æ–°å…­å†›å†›é•¿ã€‘æ¹˜è¥¿åæ”»" | split: "|" -%}
      {%- assign p10 = "start_date:1945-08-15|end_date:1946-01-01|title:ã€æ–°å…­å†›å†›é•¿ã€‘é©»é˜²äº¬æ²ª" | split: "|" -%}
      {%- assign p11 = "start_date:1946-01-01|end_date:1947-01-01|title:ã€æ–°å…­å†›å†›é•¿ã€‘ä¸œåŒ—æ”»åŠ¿ä½œæˆ˜" | split: "|" -%}
      {%- assign p12 = "start_date:1947-01-01|end_date:1948-01-01|title:ã€ç¬¬å››å…µå›¢å¸ä»¤å®˜ã€‘ä¸œåŒ—è§£å›´ä½œæˆ˜" | split: "|" -%}
      {%- assign p13 = "start_date:1948-01-01|end_date:1949-01-01|title:ã€ç¬¬ä¹å…µå›¢å¸ä»¤å®˜ã€‘ä¸œåŒ—æ’¤é€€ä½œæˆ˜" | split: "|" -%}
      {%- assign periods = periods | push: p1 | push: p2 | push: p3 | push: p4 | push: p5 | push: p6 | push: p7 | push: p8 | push: p9 | push: p10 | push: p11 | push: p12 | push: p13 -%}

      {%- for period in periods -%}
        {%- assign start_date = nil -%}
        {%- assign end_date = nil -%}
        {%- assign title = nil -%}
        {%- for prop_str in period -%}
          {%- assign prop_key = prop_str | split: ":" | first -%}
          {%- assign prop_value = prop_str | split: ":" | slice: 1 | join: ":" -%}
          {%- if prop_key == "start_date" -%}
            {%- assign start_date = prop_value -%}
          {%- elsif prop_key == "end_date" -%}
            {%- assign end_date = prop_value -%}
          {%- elsif prop_key == "title" -%}
            {%- assign title = prop_value -%}
          {%- endif -%}
        {%- endfor -%}

        {%- assign posts_in_period = "" | split: "," -%}
        {%- for post in telegrams -%}
          {%- assign post_date = post.date | date: "%Y-%m-%d" -%}
          {%- if start_date == nil and post_date < end_date -%}{%- assign posts_in_period = posts_in_period | push: post -%}{%- endif -%}
          {%- if start_date and post_date >= start_date and post_date < end_date -%}{%- assign posts_in_period = posts_in_period | push: post -%}{%- endif -%}
        {%- endfor -%}

        {%- if posts_in_period.size > 0 -%}
          <details class="collapsible-book" open>
            <summary>{{ title }}</summary>
            <ul class="timeline-list">
              {%- for post in posts_in_period -%}
              <li>
                <span class="timeline-date">{{ post.date | date: "%Y-%m-%d" }}</span>
                <div>{%- assign title_parts = post.title | split: ']' -%}{%- if title_parts.size > 1 -%}{%- assign bracket_prefix = title_parts[0] | append: ']' -%}{%- assign after_prefix = title_parts[1] -%}{%- assign first_char = after_prefix | slice: 0 -%}{%- if first_char == '1' or first_char == '2' -%}{%- assign rest_of_title = after_prefix | slice: 10, 999 -%}{%- assign title_to_display = bracket_prefix | append: rest_of_title -%}{%- else -%}{%- assign title_to_display = bracket_prefix | append: after_prefix -%}{%- endif -%}{%- else -%}{%- assign first_char = post.title | slice: 0 -%}{%- if first_char == '1' or first_char == '2' -%}{%- assign title_to_display = post.title | slice: 10, 999 -%}{%- else -%}{%- assign title_to_display = post.title -%}{%- endif -%}{%- endif -%}<a href="{{ post.url | relative_url }}">{{ title_to_display }}</a></div>
              </li>
              {%- endfor -%}
            </ul>
          </details>
        {%- endif -%}
      {%- endfor -%}
    {%- else -%}<p>æœªèƒ½ç”Ÿæˆåˆ—è¡¨ã€‚è¯·æ£€æŸ¥ `category` ä¸º `Liao's Tele` çš„æ–‡ç« æ˜¯å¦å­˜åœ¨ã€‚</p>{%- endif -%}
  </div>

  <div id="magazines" class="tabcontent">
    {%- if magazines_raw and magazines_raw.size > 0 -%}
      {%- assign dated_magazines = "" | split: "" -%}
      {%- assign undated_magazines = "" | split: "" -%}
      {%- for post in magazines_raw -%}
        {%- assign formatted_date = post.date | date: "%Y-%m-%d" -%}
        {%- if formatted_date == "1900-01-01" or post.date == nil -%}
          {%- assign undated_magazines = undated_magazines | push: post -%}
        {%- else -%}
          {%- assign dated_magazines = dated_magazines | push: post -%}
        {%- endif -%}
      {%- endfor -%}

      {%- assign dated_magazines_sorted = dated_magazines | sort: 'date' -%}
      {%- if dated_magazines_sorted.size > 0 -%}
        {%- assign periods = "" | split: "," -%}
        {%- assign p1 = "end_date:1938-02-26|title:ã€æ•™å¯¼æ€»é˜Ÿä¸­æ ¡å‚è°‹ä¸»ä»»ã€‘å—äº¬ä¿å«æˆ˜" | split: "|" -%}
        {%- assign p2 = "start_date:1938-02-26|end_date:1942-01-01|title:ã€æ–°äºŒäºŒå¸ˆå‰¯å¸ˆé•¿ã€‘æ¡‚å—ä¼šæˆ˜" | split: "|" -%}
        {%- assign p3 = "start_date:1942-01-01|end_date:1942-05-16|title:ã€æ–°äºŒäºŒå¸ˆå¸ˆé•¿ã€‘ç¬¬ä¸€æ¬¡å…¥ç¼…ä½œæˆ˜" | split: "|" -%}
        {%- assign p4 = "start_date:1942-05-16|end_date:1942-10-01|title:ã€æ–°äºŒäºŒå¸ˆå¸ˆé•¿ã€‘å¾’æ­¥é‡äººå±±" | split: "|" -%}
        {%- assign p5 = "start_date:1942-10-01|end_date:1943-11-01|title:ã€æ–°äºŒäºŒå¸ˆå¸ˆé•¿ã€‘é©»å°å†›æ•´è®­" | split: "|" -%}
        {%- assign p6 = "start_date:1943-11-01|end_date:1944-09-01|title:ã€æ–°äºŒäºŒå¸ˆå¸ˆé•¿ã€‘ç¼…åŒ—èƒœåˆ©åæ”»ï¼ˆèƒ¡åº·æ²³è°·ï¼‰" | split: "|" -%}
        {%- assign p7 = "start_date:1944-09-01|end_date:1945-01-01|title:ã€æ–°å…­å†›å†›é•¿ã€‘ç¼…åŒ—èƒœåˆ©åæ”»ï¼ˆå…«è«ã€è…ŠæˆŒï¼‰" | split: "|" -%}
        {%- assign p8 = "start_date:1945-01-01|end_date:1945-05-01|title:ã€æ–°å…­å†›å†›é•¿ã€‘äº‘å—æ›²é–æ•´è®­å¾…å‘½" | split: "|" -%}
        {%- assign p9 = "start_date:1945-05-01|end_date:1945-08-15|title:ã€æ–°å…­å†›å†›é•¿ã€‘æ¹˜è¥¿åæ”»" | split: "|" -%}
        {%- assign p10 = "start_date:1945-08-15|end_date:1946-01-01|title:ã€æ–°å…­å†›å†›é•¿ã€‘é©»é˜²äº¬æ²ª" | split: "|" -%}
        {%- assign p11 = "start_date:1946-01-01|end_date:1947-01-01|title:ã€æ–°å…­å†›å†›é•¿ã€‘ä¸œåŒ—æ”»åŠ¿ä½œæˆ˜" | split: "|" -%}
        {%- assign p12 = "start_date:1947-01-01|end_date:1948-01-01|title:ã€ç¬¬å››å…µå›¢å¸ä»¤å®˜ã€‘ä¸œåŒ—è§£å›´ä½œæˆ˜" | split: "|" -%}
        {%- assign p13 = "start_date:1948-01-01|end_date:1949-01-01|title:ã€ç¬¬ä¹å…µå›¢å¸ä»¤å®˜ã€‘ä¸œåŒ—æ’¤é€€ä½œæˆ˜" | split: "|" -%}
        {%- assign p14 = "start_date:1949-01-01|title:ã€è§£æ”¾åã€‘" | split: "|" -%}
        {%- assign periods = periods | push: p1 | push: p2 | push: p3 | push: p4 | push: p5 | push: p6 | push: p7 | push: p8 | push: p9 | push: p10 | push: p11 | push: p12 | push: p13 | push: p14 -%}

        {%- for period in periods -%}
          {%- assign start_date = nil -%}
          {%- assign end_date = nil -%}
          {%- assign title = nil -%}
          {%- for prop_str in period -%}
            {%- assign prop_key = prop_str | split: ":" | first -%}
            {%- assign prop_value = prop_str | split: ":" | slice: 1 | join: ":" -%}
            {%- if prop_key == "start_date" -%}
              {%- assign start_date = prop_value -%}
            {%- elsif prop_key == "end_date" -%}
              {%- assign end_date = prop_value -%}
            {%- elsif prop_key == "title" -%}
              {%- assign title = prop_value -%}
            {%- endif -%}
          {%- endfor -%}

          {%- assign posts_in_period = "" | split: "," -%}
          {%- for post in dated_magazines_sorted -%}
            {%- assign post_date = post.date | date: "%Y-%m-%d" -%}
            {%- if start_date == nil and post_date < end_date -%}{%- assign posts_in_period = posts_in_period | push: post -%}{%- endif -%}
            {%- if start_date and end_date == nil and post_date >= start_date -%}{%- assign posts_in_period = posts_in_period | push: post -%}{%- endif -%}
            {%- if start_date and end_date and post_date >= start_date and post_date < end_date -%}{%- assign posts_in_period = posts_in_period | push: post -%}{%- endif -%}
          {%- endfor -%}

          {%- if posts_in_period.size > 0 -%}
            <details class="collapsible-book" open>
              <summary>{{ title }}</summary>
              <ul class="timeline-list">
                {%- for post in posts_in_period -%}
                  <li>
                    <span class="timeline-date">{{ post.date | date: "%Y-%m-%d" }}</span>
                    <div><a href="{{ post.url | relative_url }}">{{ post.title }}</a>{%- if post.author -%}ï¼ˆ{{ post.author }}ï¼‰{%- endif -%}</div>
                  </li>
                {%- endfor -%}
              </ul>
            </details>
          {%- endif -%}
        {%- endfor -%}
      {%- endif -%}

      {%- if undated_magazines.size > 0 -%}
        <details class="collapsible-book" open>
          <summary>æ—¥æœŸæœªçŸ¥</summary>
          <ul class="timeline-list-no-date">
            {%- assign undated_magazines_sorted = undated_magazines | sort: 'title' -%}
            {%- for post in undated_magazines_sorted -%}
              <li><a href="{{ post.url | relative_url }}">{{ post.title }}</a>{%- if post.author -%}ï¼ˆ{{ post.author }}ï¼‰{%- endif -%}</li>
            {%- endfor -%}
          </ul>
        </details>
      {%- endif -%}
    {%- else -%}
      <p>æœªèƒ½ç”Ÿæˆåˆ—è¡¨ã€‚</p>
    {%- endif -%}
  </div>
</div>

<div id="original-view" class="view-panel">
  <div class="home">
    {% assign custom_order = "liaos_writings,ten_year_memorial,n6a_memorial,n22d_memorial,battles_history,liaos_tele,newspapers" | split: "," %}
    {% for category_name in custom_order %}{% assign collection_data = site.collections | where: "label", category_name | first %}{% if category_name == "liaos_tele" %}<details><summary><h2>{{ collection_data.display_name }}</h2></summary><ul>{% else %}{% if collection_data.display_name %}<h2>{{ collection_data.display_name }}</h2>{% else %}<h2>{{ category_name | replace: "_", " " | capitalize }}</h2>{% endif %}<ul>{% endif %}{% if category_name == "battles_history" %}{% assign year_folders = "1942,1943,1944,1945,1946,1947,1948" | split: "," %}{% for year in year_folders %}{% assign posts_in_year = site[category_name] | where_exp: "post", "post.path contains year" %}{% if posts_in_year.size > 0 %}<li><h3 class="sub-heading">{{ year }}</h3><ul>{% for post in posts_in_year %}<li><a href="{{ post.url | relative_url }}">{{ post.title }}</a></li>{% endfor %}</ul></li>{% endif %}{% endfor %}{% else %}{% assign posts_in_category = site[category_name] | sort: "title" %}{% for post in posts_in_category %}<li><a href="{{ post.url | relative_url }}">{{ post.title }}</a></li>{% endfor %}{% endif %}</ul>{% if category_name == "liaos_tele" %}</details>{% endif %}{% endfor %}
  </div>
</div>

<br/>

<h2>ç›¸å…³å·¥å…·</h2>
<ul>
  <li><a href="{{ '/quiz/n6a_name_list_.html' | relative_url }}">é™¸è»æ–°ç·¨ç¬¬å…­è»äººå“¡åå†Š</a></li>
</ul>

<h2>èµ„æ–™ä¸‹è½½åŒº</h2>
<ul>{% for file in site.static_files %}{% if file.path contains 'resources' %}<li><a href="https://github.com/lyxmemo/lyxmemo.github.io/raw/refs/heads/main/docs/resources/{{ file.basename | uri_escape }}.pdf">ä¸‹è½½ï¼š{{ file.basename }}</a></li>{% endif %}{% endfor %}</ul>


<div class="footer-view-switcher">
  <button class="switch-btn" onclick="switchView('new-view', this)">åˆ†ç±»è§†å›¾</button>
  <button class="switch-btn" onclick="switchView('original-view', this)">åŸå§‹é¦–é¡µ</button>
</div>


<script>
  // --- è§†å›¾åˆ‡æ¢åŠŸèƒ½ ---
  function switchView(viewId, clickedButton) {
    var toggleButton = document.querySelector('.floating-toggle-wrapper');
    document.querySelectorAll('.view-panel').forEach(panel => { panel.style.display = 'none'; });
    document.querySelectorAll('.footer-view-switcher .switch-btn').forEach(btn => { btn.classList.remove('active'); });
    document.getElementById(viewId).style.display = 'block';
    clickedButton.classList.add('active');
    if (viewId === 'new-view') { toggleButton.style.display = 'block'; } else { toggleButton.style.display = 'none'; }
  }

  // --- Tab åˆ‡æ¢åŠŸèƒ½ ---
  function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    var tabContainer = document.getElementById('new-view');
    tabcontent = tabContainer.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) { tabcontent[i].style.display = "none"; }
    tablinks = tabContainer.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) { tablinks[i].className = tablinks[i].className.replace(" active", ""); }
    document.getElementById(tabName).style.display = "block";
    if (evt) { evt.currentTarget.className += " active"; }
    localStorage.setItem('lastTab', tabName);
  };

  // --- å…¨éƒ¨å±•å¼€/æ”¶èµ·åŠŸèƒ½ ---
  function toggleAllMaster(selector) {
    const detailsElements = document.querySelectorAll(selector);
    if (detailsElements.length === 0) { return; }
    const hasAClosedElement = Array.from(detailsElements).some(detail => !detail.open);
    const newState = hasAClosedElement;
    detailsElements.forEach((detail) => { detail.open = newState; });
  };

  // --- é¡µé¢åŠ è½½æ—¶æ‰§è¡Œçš„é»˜è®¤æ“ä½œ ---
  document.addEventListener('DOMContentLoaded', () => {
    // é»˜è®¤åˆ‡æ¢åˆ°â€œåˆ†ç±»è§†å›¾â€
    document.querySelector('.footer-view-switcher .switch-btn').click();

    const openTabFromHash = () => {
      const hash = window.location.hash.substring(1);
      const validTabs = ['byBook', 'byTime', 'telegrams', 'magazines'];
      let tabToOpen = '';

      if (hash && validTabs.includes(hash)) {
        tabToOpen = hash;
      } else {
        const lastTab = localStorage.getItem('lastTab');
        if (lastTab && validTabs.includes(lastTab)) {
          tabToOpen = lastTab;
        } else {
          tabToOpen = 'byBook';
        }
      }
      
      const tabButton = document.getElementById(tabToOpen + '-tab');
      if (tabButton) {
        tabButton.click();
      } else {
        document.getElementById('byBook-tab').click(); // Fallback
      }
    };

    openTabFromHash();
    window.addEventListener('hashchange', openTabFromHash, false);
  });
</script>